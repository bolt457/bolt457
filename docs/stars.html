<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stars - AfricoinMarket</title>

    <script src="https://unpkg.com/react@17/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@17/umd/react-dom.development.js" crossorigin></script>
    <link rel="stylesheet" href="css/style.css">

    <style>
        /* Styles pour les cartes de stars */
        .star-card {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 20px;
            padding: 10px;
            border: 2px solid #ddd;
            border-radius: 8px;
            text-align: center;
            width: 250px;
        }
    </style>
</head>
<body>
    <header>
        <nav>
            <ul>
                <li><a href="index.html">Accueil</a></li>
                <li><a href="stars.html">Stars</a></li>
                <li><a href="statistics.html">Statistiques</a></li>
                <li><a href="shop.html">Acheter AFRICOINS</a></li>
                <li><a href="account.html">Mon Compte</a></li>
                <li><a href="ads.html">Publicités</a></li>
            </ul>
        </nav>
    </header>

    <main>
        <h2>Investissez dans les Stars</h2>
        <div id="root"></div>
        <table id="stars-table"></table>
        
        <!-- Formulaire pour ajouter une star -->
        <form id="add-star-form">
            <select id="category" required>
                <option value="actor">Acteur</option>
                <option value="athlete">Athlète</option>
                <option value="musician">Musicien</option>
            </select>
            <input type="text" id="star-id" placeholder="ID de la star" required />
            <button type="submit">Ajouter Star</button>
        </form>
    </main>

    <footer>
        <p>&copy; 2024 AfricoinMarket</p>
    </footer>

    <script src="js/StarsComponent.js" type="module"></script>
    <script src="js/frontend.js" type="module"></script>
    <script src="js/star.js" type="module"></script>

    <script>
        // Token d'autorisation Spotify
        const spotifyToken = 'BQCN3Cs42747KOZI_-D3uINuxsk91KeatLUiKLqVC-T6irObkP_t6Gto7QfJrB2txrh9lWotstsIb9nuNH0xA6rVj-VM_kbYt5k_PifldoX3YhM5MklbM370ZgmxOHb-DXe6_7GcmoganuFHjAAU9VfH2NfUkZYXmwwZius9Cv69Lbv4MXBjNml0XQzNQGdyEfYSF5hjYW3zjuIaNSNQYTv8YzDTivc28Un0HmNGFdk8GebVHpQS9fp7OJfx_AcFBwQ9wC6pHwurj2JsUFVjWfkMLAVDFcaK';
        // Token d'autorisation Football-Data
        const footballToken = '8bd2be175a294d5a95759019187c6ef3';

        async function fetchActorData(starId) {
            const apiKey = '01c9aa6b29f59a2a302d4ae8a4d0de78'; // Votre clé d'API TMDb
            const url = `https://api.themoviedb.org/3/person/${starId}?api_key=${apiKey}&language=fr-FR`;

            const response = await fetch(url);
            if (!response.ok) {
                throw new Error('Erreur lors de la récupération des données de l\'acteur.');
            }
            return response.json();
        }

        async function fetchAthleteData(starId) {
            const url = `https://api.football-data.org/v2/players/${starId}`;
            const response = await fetch(url, {
                headers: { 'X-Auth-Token': footballToken }
            });
            if (!response.ok) {
                throw new Error('Erreur lors de la récupération des données de l\'athlète.');
            }
            return response.json();
        }

        async function fetchMusicianData(starId) {
            const url = `https://api.spotify.com/v1/artists/${starId}`;
            const response = await fetch(url, {
                headers: { 'Authorization': `Bearer ${spotifyToken}` }
            });
            if (!response.ok) {
                throw new Error('Erreur lors de la récupération des données du musicien.');
            }
            return response.json();
        }

        async function fetchYouTubeData(videoId) {
            const apiKey = 'YOUR_YOUTUBE_API_KEY'; // Remplacez par votre clé API YouTube
            const url = `https://www.googleapis.com/youtube/v3/videos?id=${videoId}&key=${apiKey}&part=snippet`;

            const response = await fetch(url);
            if (!response.ok) {
                throw new Error('Erreur lors de la récupération des données de YouTube.');
            }
            return response.json();
        }

        async function fetchTikTokData(userId) {
            const url = `https://api.tiktok.com/user/${userId}`; // Remplacez par l'API TikTok appropriée
            const response = await fetch(url);
            if (!response.ok) {
                throw new Error('Erreur lors de la récupération des données de TikTok.');
            }
            return response.json();
        }

        document.addEventListener('DOMContentLoaded', function() {
            const starsTable = document.getElementById('stars-table');
            const stars = [];

            function displayStars() {
                starsTable.innerHTML = ''; 
                stars.forEach(star => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${star.name}</td>
                        <td>${star.bio}</td>
                        <td><img src="${star.image}" alt="${star.name}" width="100"></td>
                        <td><button onclick="investInStar('${star.name}')">Investir</button></td>
                    `;
                    starsTable.appendChild(row);
                });
            }

            document.getElementById('add-star-form').addEventListener('submit', async function(event) {
                event.preventDefault();
                
                const category = document.getElementById('category').value;
                const starId = document.getElementById('star-id').value;

                try {
                    let data;

                    if (category === 'actor') {
                        data = await fetchActorData(starId);
                        const name = data.name;
                        const bio = data.biography || "Aucune biographie disponible";
                        const imageUrl = data.profile_path ? `https://image.tmdb.org/t/p/w500${data.profile_path}` : "URL par défaut";
                    } else if (category === 'athlete') {
                        data = await fetchAthleteData(starId);
                        const name = data.name || data.fullName;
                        const bio = data.biography || "Aucune biographie disponible";
                        const imageUrl = data.photo || "URL par défaut"; // Assurez-vous que ce champ existe
                    } else if (category === 'musician') {
                        data = await fetchMusicianData(starId);
                        const name = data.name;
                        const bio = data.biography || "Aucune biographie disponible";
                        const imageUrl = data.images[0]?.url || "URL par défaut"; // Assurez-vous que ce champ existe
                    }

                    stars.push({ name, bio, image: imageUrl });
                    displayStars();

                    event.target.reset();
                } catch (error) {
                    alert(error.message);
                }
            });

            displayStars();
        });
    </script>
</body>
</html>